// author:   Samuel Mueller 
// version: 1.0.7 
// license:  MIT 
// homepage: http://github.com/samu/angular-table 
(function(){var a,b,c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};angular.module("angular-table",[]),a=function(){function a(a,b){this.attribute=a.attribute,this.title=a.title,this.sortable=a.sortable,this.width=a.width,this.initialSorting=a.initialSorting,b&&(this.customContent=b.customContent,this.attributes=b.attributes)}return a.prototype.createElement=function(){var a;return a=angular.element(document.createElement("th"))},a.prototype.renderTitle=function(a){return a.html(this.customContent||this.title)},a.prototype.renderAttributes=function(a){var b,c,d,e,f;if(this.customContent){for(e=this.attributes,f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push(a.attr(b.name,b.value));return f}},a.prototype.renderSorting=function(a){var b;return this.sortable?(a.attr("ng-click","predicate = '"+this.attribute+"'; descending = !descending;"),b=angular.element("<i style='margin-left: 10px;'></i>"),b.attr("ng-class","getSortIcon('"+this.attribute+"', predicate, descending)"),a.append(b)):void 0},a.prototype.renderWidth=function(a){return a.attr("width",this.width)},a.prototype.renderHtml=function(){var a;return a=this.createElement(),this.renderTitle(a),this.renderAttributes(a),this.renderSorting(a),this.renderWidth(a),a},a}(),i=function(){function a(a){this.configObjectName=a,this.itemsPerPage=""+this.configObjectName+".itemsPerPage",this.sortContext=""+this.configObjectName+".sortContext",this.fillLastPage=""+this.configObjectName+".fillLastPage",this.maxPages=""+this.configObjectName+".maxPages",this.currentPage=""+this.configObjectName+".currentPage",this.orderBy=""+this.configObjectName+".orderBy",this.paginatorLabels=""+this.configObjectName+".paginatorLabels"}return a}(),d=function(){function a(a,b,c){this.scope=a,this.configurationVariableNames=b,this.listName=c}return a.prototype.getList=function(){return this.scope.$eval(this.listName)},a.prototype.getItemsPerPage=function(){return this.scope.$eval(this.configurationVariableNames.itemsPerPage)||10},a.prototype.getCurrentPage=function(){return this.scope.$eval(this.configurationVariableNames.currentPage)||0},a.prototype.getMaxPages=function(){return this.scope.$eval(this.configurationVariableNames.maxPages)||void 0},a.prototype.getSortContext=function(){return this.scope.$eval(this.configurationVariableNames.sortContext)||"global"},a.prototype.setCurrentPage=function(a){return this.scope.$eval(""+this.configurationVariableNames.currentPage+"="+a)},a.prototype.getOrderBy=function(){return this.scope.$eval(this.configurationVariableNames.orderBy)||"orderBy"},a.prototype.getPaginatorLabels=function(){var a;return a={stepBack:"‹",stepAhead:"›",jumpBack:"«",jumpAhead:"»",first:"First",last:"Last"},this.scope.$eval(this.configurationVariableNames.paginatorLabels)||a},a}(),h=function(){function b(a,b){this.tableElement=a,this.attributes=b,this.id=this.attributes.id,this.config=this.attributes.atConfig,this.paginated=null!=this.attributes.atPaginated,this.list=this.attributes.atList,this.createColumnConfigurations()}return b.prototype.capitaliseFirstLetter=function(a){return a?a.charAt(0).toUpperCase()+a.slice(1):""},b.prototype.extractWidth=function(a){var b;return b=/([0-9]+px)/i.exec(a),b?b[0]:""},b.prototype.isSortable=function(a){var b;return b=/(sortable)/i.exec(a),b?!0:!1},b.prototype.getInitialSorting=function(a){var b;if(b=a.attr("at-initial-sorting")){if("asc"===b||"desc"===b)return b;throw"Invalid value for initial-sorting: "+b+". Allowed values are 'asc' or 'desc'."}return void 0},b.prototype.collectHeaderMarkup=function(a){var b,c,d,e,f,g;for(b={},d=a.find("tr"),g=d.find("th"),e=0,f=g.length;f>e;e++)c=g[e],c=angular.element(c),b[c.attr("at-attribute")]={customContent:c.html(),attributes:c[0].attributes};return b},b.prototype.collectBodyMarkup=function(a){var b,c,d,e,f,g,h,i,j,k;for(c=[],k=a.find("td"),i=0,j=k.length;j>i;i++)f=k[i],f=angular.element(f),b=f.attr("at-attribute"),g=f.attr("at-title")||this.capitaliseFirstLetter(f.attr("at-attribute")),e=void 0!==f.attr("at-sortable")||this.isSortable(f.attr("class")),h=this.extractWidth(f.attr("class")),d=this.getInitialSorting(f),c.push({attribute:b,title:g,sortable:e,width:h,initialSorting:d});return c},b.prototype.createColumnConfigurations=function(){var b,c,d,e,f;for(c=this.collectHeaderMarkup(this.tableElement),b=this.collectBodyMarkup(this.tableElement),this.columnConfigurations=[],e=0,f=b.length;f>e;e++)d=b[e],this.columnConfigurations.push(new a(d,c[d.attribute]))},b}(),e=function(){function a(){}return a.prototype.setupTr=function(a,b){var c,d;return c=a.find("tbody"),d=c.find("tr"),d.attr("ng-repeat",b),c},a}(),f=function(a){function b(a,b){this.list=b,this.repeatString="item in "+this.list+" | orderBy:predicate:descending"}return l(b,a),b.prototype.compile=function(a,b,c){return this.setupTr(a,this.repeatString)},b.prototype.link=function(){},b}(e),c=function(a){function b(a){this.configurationVariableNames=a,this.repeatString="item in sortedAndPaginatedList"}return l(b,a),b.prototype.compile=function(a){var b,c,d,e,f,g,h;for(c=this.setupTr(a,this.repeatString),f=a.find("td"),e="",g=0,h=f.length;h>g;g++)d=f[g],e+="<td><span>&nbsp;</span></td>";b=angular.element(document.createElement("tr")),b.attr("ng-show",this.configurationVariableNames.fillLastPage),b.html(e),b.attr("ng-repeat","item in fillerArray"),c.append(b)},b.prototype.link=function(a,b,c,e){var f,g,h,i,j;return f=this.configurationVariableNames,j=new d(a,f,c.atList),h=function(a,b,c,d,e,f,g,h){var i,j;return a?(j=a,i=c*b-a.length,"global"===e?(j=h(d)(j,f,g),j=h("limitTo")(j,i),j=h("limitTo")(j,c)):(j=h("limitTo")(j,i),j=h("limitTo")(j,c),j=h(d)(j,f,g)),j):[]},g=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n;if(d=parseInt(d),a.length<=0){for(m=[],g=h=0,j=d-1;j>=0?j>=h:h>=j;g=j>=0?++h:--h)m.push(g);return m}if(b===c-1){if(f=a.length%d,0!==f){for(e=d-f-1,n=[],g=i=k=a.length,l=a.length+e;l>=k?l>=i:i>=l;g=l>=k?++i:--i)n.push(g);return n}return[]}},i=function(){var b;return a.sortedAndPaginatedList=h(j.getList(),j.getCurrentPage(),j.getItemsPerPage(),j.getOrderBy(),j.getSortContext(),a.predicate,a.descending,e),b=Math.ceil(j.getList().length/j.getItemsPerPage()),a.fillerArray=g(j.getList(),j.getCurrentPage(),b,j.getItemsPerPage())},a.$watch(f.currentPage,function(){return i()}),a.$watch(f.itemsPerPage,function(){return i()}),a.$watch(f.sortContext,function(){return i()}),a.$watchCollection(c.atList,function(){return i()}),a.$watch(""+c.atList+".length",function(){return a.numberOfPages=Math.ceil(j.getList().length/j.getItemsPerPage()),i()}),a.$watch("predicate",function(){return i()}),a.$watch("descending",function(){return i()})},b}(e),g=function(){function a(a,b,c){this.element=a,this.tableConfiguration=b,this.configurationVariableNames=c}return a.prototype.constructHeader=function(){var a,b,c,d,e;for(b=angular.element(document.createElement("tr")),e=this.tableConfiguration.columnConfigurations,c=0,d=e.length;d>c;c++)a=e[c],b.append(a.renderHtml());return b},a.prototype.setupHeader=function(){var a,b,c;return b=this.element.find("thead"),b?(a=this.constructHeader(),c=angular.element(b).find("tr"),c.remove(),b.append(a)):void 0},a.prototype.getSetup=function(){return this.tableConfiguration.paginated?new c(this.configurationVariableNames):new f(this.configurationVariableNames,this.tableConfiguration.list)},a.prototype.compile=function(){return this.setupHeader(),this.setup=this.getSetup(),this.setup.compile(this.element)},a.prototype.setupInitialSorting=function(a){var b,c,d,e,f;for(e=this.tableConfiguration.columnConfigurations,f=[],c=0,d=e.length;d>c;c++)if(b=e[c],b.initialSorting){if(!b.attribute)throw"initial-sorting specified without attribute.";a.predicate=b.attribute,f.push(a.descending="desc"===b.initialSorting)}else f.push(void 0);return f},a.prototype.post=function(a,b,c,d){return this.setupInitialSorting(a),a.getSortIcon||(a.getSortIcon=function(b,c,d){return b!==a.predicate?"glyphicon glyphicon-minus":d?"glyphicon glyphicon-chevron-down":"glyphicon glyphicon-chevron-up"}),this.setup.link(a,b,c,d)},a}(),b=function(){function a(a,b,c,d){if(this.lowerBound=null!=a?a:0,this.upperBound=null!=b?b:1,null==c&&(c=0),this.length=null!=d?d:1,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";this.data=this.generate(c)}return a.prototype.generate=function(a){var b,c,d,e;for(a>this.upperBound-this.length?a=this.upperBound-this.length:a<this.lowerBound&&(a=this.lowerBound),e=[],b=c=a,d=parseInt(a)+parseInt(this.length)-1;d>=a?d>=c:c>=d;b=d>=a?++c:--c)e.push(b);return e},a.prototype.resetParameters=function(a,b,c){if(this.lowerBound=a,this.upperBound=b,this.length=c,this.length>this.upperBound-this.lowerBound)throw"sequence is too long";return this.data=this.generate(this.data[0])},a.prototype.relocate=function(a){var b;return b=this.data[0]+a,this.data=this.generate(b,b+this.length)},a.prototype.realignGreedy=function(a){var b;return a<this.data[0]?(b=a,this.data=this.generate(b)):a>this.data[this.length-1]?(b=a-(this.length-1),this.data=this.generate(b)):void 0},a.prototype.realignGenerous=function(a){},a}(),j="<div style='margin: 0px;'> <ul class='pagination'> <li ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' ng-click='stepPage(-numberOfPages)'>{{getPaginatorLabels().first}}</a> </li> <li ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' ng-click='jumpBack()'>{{getPaginatorLabels().jumpBack}}</a> </li> <li ng-class='{disabled: getCurrentPage() <= 0}'> <a href='' ng-click='stepPage(-1)'>{{getPaginatorLabels().stepBack}}</a> </li> <li ng-class='{active: getCurrentPage() == page}' ng-repeat='page in pageSequence.data'> <a href='' ng-click='goToPage(page)' ng-bind='page + 1'></a> </li> <li ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' ng-click='stepPage(1)'>{{getPaginatorLabels().stepAhead}}</a> </li> <li ng-show='showSectioning()' ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' ng-click='jumpAhead()'>{{getPaginatorLabels().jumpAhead}}</a> </li> <li ng-class='{disabled: getCurrentPage() >= numberOfPages - 1}'> <a href='' ng-click='stepPage(numberOfPages)'>{{getPaginatorLabels().last}}</a> </li> </ul> </div>",angular.module("angular-table").directive("atTable",["$filter",function(a){return{restrict:"AC",scope:!0,compile:function(b,c,d){var e,f,j;return j=new h(b,c),e=new i(c.atConfig),f=new g(b,j,e),f.compile(),{post:function(b,c,d){return f.post(b,c,d,a)}}}}}]),angular.module("angular-table").directive("atPagination",[function(){return{restrict:"E",scope:!0,replace:!0,template:j,link:function(a,c,e){var f,g,h,j,k,l;return f=new i(e.atConfig),l=new d(a,f,e.atList),h=function(a,b,c){return a=Math.max(b,a),Math.min(c,a)},g=function(){return a.numberOfPages},j=function(b){return a.numberOfPages=b},k=function(b){var c,d;return l.getList()?l.getList().length>0?(c=Math.ceil(l.getList().length/l.getItemsPerPage()),j(c),d=a.showSectioning()?l.getMaxPages():c,a.pageSequence.resetParameters(0,c,d),l.setCurrentPage(h(l.getCurrentPage(),0,g()-1)),a.pageSequence.realignGreedy(l.getCurrentPage())):(j(1),a.pageSequence.resetParameters(0,1,1),l.setCurrentPage(0),a.pageSequence.realignGreedy(0)):void 0},a.showSectioning=function(){return l.getMaxPages()&&g()>l.getMaxPages()},a.getCurrentPage=function(){return l.getCurrentPage()},a.getPaginatorLabels=function(){return l.getPaginatorLabels()},a.stepPage=function(b){return b=parseInt(b),l.setCurrentPage(h(l.getCurrentPage()+b,0,g()-1)),a.pageSequence.realignGreedy(l.getCurrentPage())},a.goToPage=function(a){return l.setCurrentPage(a)},a.jumpBack=function(){return a.stepPage(-l.getMaxPages())},a.jumpAhead=function(){return a.stepPage(l.getMaxPages())},a.pageSequence=new b,a.$watch(f.itemsPerPage,function(){return k()}),a.$watch(f.maxPages,function(){return k()}),a.$watch(e.atList,function(){return k()}),a.$watch(""+e.atList+".length",function(){return k()}),k()}}}]),angular.module("angular-table").directive("atImplicit",[function(){return{restrict:"AC",compile:function(a,b,c){var d;if(d=a.attr("at-attribute"),!d)throw"at-implicit specified without at-attribute: "+a.html();return a.append("<span ng-bind='item."+d+"'></span>")}}}])}).call(this);